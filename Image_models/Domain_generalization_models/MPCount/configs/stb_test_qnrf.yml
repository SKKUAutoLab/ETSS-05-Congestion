# general config
seed: 2023
version: stb
device: 'cuda:0'
log_para: 1000
patch_size: 10000
mode: 'final'
num_epochs: 180
checkpoint: logs/stb/best.pth

# model config
model:
  name: 'final'
  params:
    pretrained: True
    mem_size: 1024
    mem_dim: 256
    cls_thrs: 0.5
    err_thrs: 0.5
    den_dropout: 0.5
    cls_dropout: 0.3
    has_err_loss: False

# train config
train_dataset: &train_dataset_params
  name: 'den_cls'
  params: 
    root: 'data/stb'
    crop_size: 320
    downsample: 1
    is_grey: False
    unit_size: 16
    pre_resize: 1

# val config
val_dataset: *train_dataset_params

# test config
test_dataset:
  name: 'den_cls'
  params: 
    root: 'data/qnrf'
    crop_size: 320
    downsample: 1
    is_grey: False
    unit_size: 16
    pre_resize: 1

# train loader config
train_loader:
  batch_size: 16
  num_workers: 16
  shuffle: True
  pin_memory: True

# val loader config
val_loader: &val_loader_params
  batch_size: 1
  num_workers: 4
  shuffle: False
  pin_memory: False

# test loader config
test_loader: *val_loader_params

# optimizer config
optimizer:
  name: 'adamw'
  params:
    lr: &lr 0.001
    weight_decay: 0.0001

# scheduler config
scheduler:
  name: 'onecycle'
  params:
    max_lr: *lr
    epochs: 300
    steps_per_epoch: 20
    final_div_factor: 1000